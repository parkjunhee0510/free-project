<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous">
      <link rel="stylesheet" type="text/css" href="/style/main.css">
    </head>
    <body>
      <div class="header-box">
          <h3><span>ALCOHOL</span> FREE</h3>
          <p></p>
          <button class="btn">Login</a></button> 
          <p>시발</p>
        </div>
        <hr />
        <nav id="navbar">
          <ul>
            <li><a class="menuLink" href="/list">글 목록</a></li>
            <li><a class="menuLink" href="#">메뉴2</a></li>
            <li><a class="menuLink" href="#">메뉴3</a></li>
            <li><a class="menuLink" href="#">메뉴4</a></li>
          </ul>
        </nav>
        <hr />
        
    <h4 class="m1-2 my-3">서버에서 가져오는 리스트</h4>

    <ul class="list-group">
      <% for (var i = 0; i < posts.length; i++){ %>
      <li class="list-group-item">
        <p>글 번호 : <%= posts[i]._id %></p>
        <h4>할일 제목 : ? <%= posts[i].제목 %></h4>
        <p>할일 마감 날짜 : <%= posts[i].내용 %></p>
        <button class="delete btn btn-danger" data-id="<%= posts[i]._id%>">삭제</button>
      </li>
      <% } %>
    </ul>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

    <!-- ajax 를 활용한 서버에 삭제 요청 보내기 -->
    <script>

      $(".delete").click((e) => {
        

        var w = e.target.dataset.id; //button의 데이터 값을받아 넘겨주는 함수.
        $.ajax({
          method: "DELETE",
          url: "/delete",
          data: {_id:e.target.dataset.id},
        }).done((결과) => {
          console.log("삭제완료");
          $(e.target).parents('li').fadeOut(); //버튼 클릭시 버튼의 부모객체 li가 사라지는 함수
        }).fail(() => {

        });
      });



    </script>

  </body>
</html>
